<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>İki Kişilik Sohbet</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 500px; margin: auto; padding: 20px; background-color: #ece5dd; }
        h2 { color: #075E54; }
        #login, #chat { display: none; }
        #messages { background: #fff; border-radius: 5px; border: 1px solid #ccc; height: 400px; overflow-y: scroll; padding: 10px; margin-bottom: 10px; }
        .message { display: flex; align-items: center; margin: 5px 0; padding: 8px; border-radius: 8px; max-width: 70%; clear: both; }
        .me { background-color: #dcf8c6; align-self: flex-end; float: right; }
        .other { background-color: #fff; border: 1px solid #ccc; float: left; }
        .avatar { width: 30px; height: 30px; border-radius: 50%; margin-right: 8px; }
        #inputArea { display: flex; }
        #inputArea input { flex: 1; padding: 10px; border-radius: 20px; border: 1px solid #ccc; margin-right: 5px; }
        #inputArea button { padding: 10px 20px; background-color: #075E54; color: white; border: none; border-radius: 20px; }
        #clearButton { background-color: #d9534f; margin-left: 10px; }
    </style>
</head>
<body>

<h2>Giriş Yap</h2>
<div id="login">
    <input type="text" id="username" placeholder="Kullanıcı Adı">
    <input type="password" id="password" placeholder="Şifre">
    <button onclick="login()">Giriş Yap</button>
    <p id="loginError" style="color: red;"></p>
</div>

<div id="chat">
    <h3 style="color:#075E54;">Hoş geldin, <span id="currentUser"></span></h3>
    <div id="messages"></div>
    <div id="inputArea">
        <input type="text" id="messageInput" placeholder="Mesaj yaz...">
        <button onclick="sendMessage()">Gönder</button>
        <button id="clearButton" onclick="clearChat()">Sohbeti Sil</button>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCPejajCJIhR_STwr6Czm_hGsOLEPng3Bw",
        authDomain: "sohbet-sitesi-2d0d8.firebaseapp.com",
        databaseURL: "https://sohbet-sitesi-2d0d8-default-rtdb.firebaseio.com",
        projectId: "sohbet-sitesi-2d0d8",
        storageBucket: "sohbet-sitesi-2d0d8.appspot.com",
        messagingSenderId: "554862357464",
        appId: "1:554862357464:web:ea1f72b4627147b47460ad"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const validUsers = {
        erenyel: '0507eren2003',
        edayontem: 'eday2003'
    };

    let currentUser = '';

    const userAvatars = {
        erenyel: 'eren.png',
        edayontem: 'eda.png'
    };

    document.getElementById('login').style.display = 'block';

    function login() {
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value.trim();

        if (validUsers[username] && validUsers[username] === password) {
            currentUser = username;
            document.getElementById('login').style.display = 'none';
            document.getElementById('chat').style.display = 'block';
            document.getElementById('currentUser').innerText = currentUser;
            listenForMessages();
        } else {
            document.getElementById('loginError').innerText = 'Hatalı kullanıcı adı veya şifre!';
        }
    }

    function sendMessage() {
        const input = document.getElementById('messageInput');
        const message = input.value.trim();
        if (message === '') return;

        db.ref('messages').push({
            user: currentUser,
            text: message,
            timestamp: Date.now()
        });

        input.value = '';
    }

    function listenForMessages() {
        const messagesDiv = document.getElementById('messages');
        messagesDiv.innerHTML = '';

        db.ref('messages').on('child_added', function(snapshot) {
            const msg = snapshot.val();
            const msgElement = document.createElement('div');
            msgElement.classList.add('message');
            msgElement.classList.add(msg.user === currentUser ? 'me' : 'other');

            const avatar = document.createElement('img');
            avatar.src = userAvatars[msg.user];
            avatar.className = 'avatar';

            const textSpan = document.createElement('span');
            textSpan.innerText = `${msg.user}: ${msg.text}`;

            msgElement.appendChild(avatar);
            msgElement.appendChild(textSpan);
            messagesDiv.appendChild(msgElement);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        });
    }

    function clearChat() {
        const confirmation = prompt("Sohbeti silmek için şifreyi girin:");
        if (confirmation === '123') {
            document.getElementById('messages').innerHTML = '';
            alert('Sadece kendi ekranındaki sohbet temizlendi!');
        } else {
            alert('Yanlış şifre!');
        }
    }
</script>

</body>
</html>
